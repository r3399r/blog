---
title: "[2025-07] 事情果然不能混在一起做"
date: 2025-08-01T10:55:02+08:00
draft: false
tags: ["altarf","spica","polaris","gaia"]
categories: ["journal"]
---
<!--more-->
## 小結
<div >
<img src="/images/journal-2025-07.png" >
</div>

總投入時間: 24.93 hr

每日平均: 48.24 min

## 做了什麼

從這個月的統計結果看起來，一件事情沒有做完，無論拖再久，真的是捨不得就此中斷呢!

因為上個月建了一顆 AWS RDS MySQL 資料庫，先把 `polaris` 相關的函數做了轉移，也用了內網去連資料庫，覺得很完美。但其實這個月的惡夢才悄悄開始...

`polaris` 這個系統的功用在於監控，監控其他的專案是否正常在運作，觀察是否使用者的版本有走在更新的道路上...等等，然後發現上個月進行框架大改版的 `spica` 很多人都卡在舊版，我自己使用中的網站也不例外，追根究柢起來發現是 PWA 在搞怪，當初知道這個概念的時候覺得 PWA 是未來的大趨勢，但似乎並不真的如此，主因大概是因為 iOS 始終不把 PWA 希望的功能放出來，iOS 用戶又占了很大一部份比例，PWA 的道路因此沒有我想像的那麼光明... 講偏了，PWA 會很忠心的 cache 在 Android 系統裡，不會輕易清除，我找了好久才終於找到該怎麼辦，驚人的是，解法居然只有一行 code... 我美好的周末時光全部都奉獻給了 `spica`。至少解決了，而且只花了一個周末~

下半月大部分時間在處理 `altarf` 的上線準備，原本都準備好了，因為有新資料庫可以用，索性決定把資料都轉寫到新資料庫，畢竟是全新的專案，沒有搬遷問題，想到 `spica` 未來如果要做搬遷，是個多麼浩大的工程呢... 搬遷的過程理論上是順利的，卡住的地方是... 我發現 AWS 在吃我的錢，最先發現的是資料庫的內網功能...原來是要錢的啊!!!! 而且，它好貴!!!!!! 費用比資料庫還貴，我都有點捨不得開新資料庫產生的費用了，居然冷不防給我一個大的! 我覺得 AWS 最討厭的地方是，有時候沒做好功課，就會開始在沒注意到的地方開始燒錢。趕快改一下資料庫的設定，然後用 `polaris` 進行測試，也是花了不少時間。

覺得一切妥當之後繼續處理 `altarf` 的資料處理，過兩天觀察帳單，又發現還有地方在默默燒錢，雖然金額沒有網路功能那麼大，但累積起來也是不容小覷，深挖一番之後才找到來源，是之前設定網路功能時順便打開的一個 IP 設定，唉... 就說這是 AWS 最討厭的地方了吧!

燒錢的地方都砍乾淨之後，`altarf` 也迎接了它的正式上線，賀~~~ 之後再慢慢觀察使用者的使用狀況。

然後 AWS 帳單來了，我赫然發現 SQS 的用量異常之高，我確實有頻繁的使用 SQS，但是每月一百萬次的免費額度居然被我用完了，明明同樣是一百萬次免費額度的 Lambda 都遠遠用不到那麼多次，問題在哪裡呢? 深掘之後發現即使 SQS 沒有 event 時，也會空轉每分鐘產生 900 次的 request，發現之後先把測試環境用的 SQS 關掉，然後比正式環境的 concurrency 調低，讓空轉產生的 request 降低，希望能大幅減少 SQS 的 request 次數，如果真的降不下來可能考慮改用 eventBridge 主動取得 event... 八月來了，這個要持續觀察呢!

## 八月期許

`altarf` 上線之後應該會消極一陣子吧，觀察使用者狀況，討論要如何改版。另外，`spica` 新版的設計都好了，不知道八月有沒有機會完成，加油啦~